---
layout:     post
title:       重构 ——-- 记录 One
subtitle:    "\" ”重构“笔记之重构的原则 —— 笔记\""
date:       2018-08-19
author:     wangshouchang
header-img: img/post-bg-2015.jpg
catalog: true
tags:
    - 学习
    - 读书
    - Java
    - 重构


---

### 重构的原则

**什么是重构**

  首先我们考虑什么是重构，重构就是对软件内部的一种调整，目的是在不改变软件可观察范围内，提高其可读性。

**我们为什么需要重构**

  重构使软件更容易理解，在编码的过程是我们的代码会越来越杂乱无序。每当过一段时间我们需要将代码的结构进行订正也就是重构，使代码的可读性增加。

**重构的一些好处**

1. 重构能找到Bug
2. 重构提高编程速度

**那么我们何时进行重构**

重构不是一件应该特别拔出准备时间的事情，重构应该是在随时随地进行的过程。

1. 添加功能
   1. 你在对新的需求做编码，发现此处的代码有冗余。这时你就可以着手做重构了。
   2. 添加新功能时，发现旧的代码不能满足需求。可以开始重构了。
2. 修补错误时重构
   1. 在修bug时重构可以对代码有着更深的印象。
3. 复审代码的时候重构
   1. 在代码的复审过程中会发现问题
   2. 在复审过程中他人会提出有效的意见
   3. 同复审可以排查出代码中的问题

**重构的难题**

1. 如何解决与数据库的关系

   1. 解决办法是在对象模型和数据库模型之间插入一个分隔层这样就可以隔离两个模型各自的变化
   2. 通过中间层的的处理上层和下层无需知道两者之间的关系，当上下层需要做变动的时候只要对中间层做变更就行了

2. 修改接口

   1. 对于那些已经发布的接口如何做处理
   2. 先把接口加上deprecated 进行标记，然后创建一个新的接口进行替代
   3. 同时维护两套接口是复杂的，这时就需要沟通然后把旧的接口进行下架

3. 难以通过重构手法完成的设计改动

4. 何时不该重构

   1.  项目的后期
   2. 时间紧急
   3. 在重构前确认代码是能正常运行的

5. 重构与性能

   1. 时间预算法，重构后的代码对时间要起很高
   2. 持续关注法， coder在任何时候都需要设法保持系统的高性能
   3. 利用上诉90%统计数据方法， 将注意力集中在热点上，优化局部


### 代码的坏味道

下面我们将介绍一些不好的编码习惯，这些编码习惯会使你的代码变得越来越复杂，冗余

1. 重复的代码
2. 过长的函数
3. 过大的类
4. 过长的参数
5. 发散式变化 （将代码中需要修改的地方放在同一个地方修改）
6. 霹弹式修改（每次修改，都要在很多处修改）
7. 依恋情结（将数据和数据处理柔和了在一起）
8. 数据泥团（过多的数据项，包括在方法的参数中）
9. 基本数据偏执（将基本数据值 组合之后更换为对象类型）
10. switch 惊悚现身（少使用switch case 语句）当出现switch语句时可以尝试使用多态来替换它
11. 平行继承关系 
12. 冗赘类 （不要创建没有用的，多余的类）
13. 夸夸其谈未来性
14. 令人啊迷惑的暂时字段（慎用暂时字段，这样的话别人不知道你这个字段的作用）
15. 过度耦合的信息链 （A对象请求B， B对象再去请求C，C再去请求D这样连续下去）
16. 中间人 （过度的使用了封装和委托） 
17. 过度亲密关系（两个类过度亲密，要么将其共同的部分放在同一个类里面）
18. 异曲同工类（两个类名字不同，但在作用相同）
19. 不完美的类库（复用了不完美的类库，导致后期维护困难）
20. 纯稚的数据类 （只拥有一些字段的数据，用于访问读写）
21. 被拒绝的遗赠（继承了父类的方法，但是不希望使用它）
22. 过多的注释（精简，有用的字段）



### 构建测试体系

**自测试代码的价值**

   其实在日常的开发中，编码只占了开发的20%其实绝大多数的时间都是处理其他的问题，例如与客户沟通，与协作方沟通。还有就是修复BUG。

coder的绝大多数时间都是在解决问题，解决BUG。

那么问题来了，有什么可以减少BUG的存在。

1. 编码的细心
2. 业务的处理规范
3. 防御性编程
4. 构建丰富的测试用例
5. 对自己的代码负责

其实使用频繁的测试就是 **极限编程**的一种

另外我们可以JUnit测试框架来进行测试用例的搭建

###  重构列表

**重构的记录格式**

1. 重构的名称. 
2. 名称后的简单该要
3. 动机  为什么要对这部分进行重构
4. 做法 如何进行重构
5. 范例  简单例子说明的例子说明此重构手法

**优秀的重构技巧**

重构的基本技巧 ——— 小步前进——— 频繁测试

在重构的时候使用一些设计模式技巧

- 模式和重构之间有着一种与生俱来。模式是你希望到目标，重构则到达之路





### 重新组织函数 



如何重新的构



